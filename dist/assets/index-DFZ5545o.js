(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const h of s.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const u=20,E=14,O=30,p={UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight"},y=new Audio("./tetris.mp3"),a=document.querySelector("canvas"),c=a.getContext("2d"),R=document.querySelector("strong span"),w=document.querySelector("section");let x=0;a.width=u*E;a.height=u*O;c.scale(u,u);const l=S(E,O);function S(o,t){return Array(t).fill().map(()=>Array(o).fill(0))}const d=[[[1,1,1,1]],[[0,1,0],[1,1,1]],[[1,1,0],[0,1,1]],[[0,1,1],[1,1,0]],[[1,1],[1,1]]],e={position:{x:5,y:0},shape:d[Math.floor(Math.random()*d.length)]};let m=0,g=0;function A(o=0){const t=o-g;g=o,m+=t,m>1e3&&(e.position.y++,m=0,f()&&(e.position.y--,T(),L())),v(),window.requestAnimationFrame(A)}function v(){c.fillStyle="#000",c.fillRect(0,0,a.width,a.height),l.forEach((o,t)=>{o.forEach((n,r)=>{n==1&&(c.fillStyle="yellow",c.fillRect(r,t,1,1))})}),e.shape.forEach((o,t)=>{o.forEach((n,r)=>{n&&(c.fillStyle="red",c.fillRect(e.position.x+r,e.position.y+t,1,1))})}),R.innerText=x}document.addEventListener("keydown",o=>{if(o.key===p.LEFT&&(e.position.x--,f()&&e.position.x++),o.key===p.RIGHT&&(e.position.x++,f()&&e.position.x--),o.key===p.DOWN&&(e.position.y++,f()&&(e.position.y--,T(),L())),o.key===p.UP){const t=[];for(let r=0;r<e.shape[0].length;r++){const i=[];for(let s=e.shape.length-1;s>=0;s--)i.push(e.shape[s][r]);t.push(i)}const n=e.shape;e.shape=t,f()&&(e.shape=n)}});function f(){return e.shape.find((o,t)=>o.find((n,r)=>n!=0&&l[t+e.position.y]?.[r+e.position.x]!=0))}function T(){e.shape.forEach((o,t)=>{o.forEach((n,r)=>{n==1&&(l[t+e.position.y][r+e.position.x]=1)})}),e.shape=d[Math.floor(Math.random()*d.length)],e.position.x=0,e.position.y=0,f()&&(window.alert("Game Over"),l.forEach(o=>o.fill(0)))}function L(){const o=[];l.forEach((t,n)=>{t.every(r=>r===1)&&o.push(n)}),o.forEach(t=>{l.splice(t,1);const n=Array(E).fill(0);l.unshift(n),x+=10})}w.addEventListener("click",()=>{w.style.display="none",A(),y.loop=!0,y.volume=.1,y.play()});
